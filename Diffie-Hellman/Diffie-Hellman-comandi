┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ openssl genpkey -genparam -algorithm DH -out parametersPG.pem
........+.................................................................................................................................................................................+...............................................................................................................+....................................+.....................................+..............................................................................................................................................................................................................................+............................................+..................................................................................................................................................+...............................................................................................................................................................................................................+.........................................................................................................+...+..........+.................................................+.............................................................................................................................................................................+.................................................................................................................................+.......................................................................................+.....................+..........................................................................................................+................................................................................................................................................+..................+.......................................+..................................+....................................................................................................................................................+..........+.............................................................................................................................................+........+..........+....................................................................................................................+...........................................+........+...............................................................................................................................................................................................................................+........................................................................................................................................................+....................................................................................................................................................................................................+..................................................................................................................................+.......................................................................+.........................................+....................................................................+........................................................................................................+........................................................................+...............................................+.......................................................++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*++*

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ openssl pkeyparam -in parametersPG.pem -text                             
-----BEGIN DH PARAMETERS-----
MIIBDAKCAQEAu5vAYlkOr1iwTLCwau4iHggIDQDh4+efUkYqtS0UYZ1f43ZZUIMu
IdJtIUsqDtjli+XPjrpTxUnjqf3MP0fxMgdpIH4hrtd7AAyEb7LglthEY3KlLJrP
tysl1eXI5+Vl1CuTJRr/XHEsQ08rPW+swvIsPw0Y5eR65llF8eKw4lVdOkN9TscA
eMsiiDNwyzJWNwmqXjvkFZ6pY0ZpXTfX8vTIsy5brWe8e2mjG/j7H78FgB7e8xae
qBQZfqEfa1ZcHmsHyf9tJTgjiqJxrCBGgayTkNP9JBVEUjZBvFVTsS/DVd0NdYEm
Q/fOYU5t3ZZfe4W1xhrKPvXl2VazPoreZwIBAgICAOE=
-----END DH PARAMETERS-----
DH Parameters: (2048 bit)
P:   
    00:bb:9b:c0:62:59:0e:af:58:b0:4c:b0:b0:6a:ee:
    22:1e:08:08:0d:00:e1:e3:e7:9f:52:46:2a:b5:2d:
    14:61:9d:5f:e3:76:59:50:83:2e:21:d2:6d:21:4b:
    2a:0e:d8:e5:8b:e5:cf:8e:ba:53:c5:49:e3:a9:fd:
    cc:3f:47:f1:32:07:69:20:7e:21:ae:d7:7b:00:0c:
    84:6f:b2:e0:96:d8:44:63:72:a5:2c:9a:cf:b7:2b:
    25:d5:e5:c8:e7:e5:65:d4:2b:93:25:1a:ff:5c:71:
    2c:43:4f:2b:3d:6f:ac:c2:f2:2c:3f:0d:18:e5:e4:
    7a:e6:59:45:f1:e2:b0:e2:55:5d:3a:43:7d:4e:c7:
    00:78:cb:22:88:33:70:cb:32:56:37:09:aa:5e:3b:
    e4:15:9e:a9:63:46:69:5d:37:d7:f2:f4:c8:b3:2e:
    5b:ad:67:bc:7b:69:a3:1b:f8:fb:1f:bf:05:80:1e:
    de:f3:16:9e:a8:14:19:7e:a1:1f:6b:56:5c:1e:6b:
    07:c9:ff:6d:25:38:23:8a:a2:71:ac:20:46:81:ac:
    93:90:d3:fd:24:15:44:52:36:41:bc:55:53:b1:2f:
    c3:55:dd:0d:75:81:26:43:f7:ce:61:4e:6d:dd:96:
    5f:7b:85:b5:c6:1a:ca:3e:f5:e5:d9:56:b3:3e:8a:
    de:67
G:    2 (0x2)
recommended-private-length: 225 bits

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ openssl genpkey -paramfile parametersPG.pem -out AlicePublicPrivateKeyPair.pem


┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ pkey -in AlicePublicPrivateKeyPair.pem -text -noout                      
Command 'pkey' not found, did you mean:
  command 'rkey' from deb plc-utils-extra
  command 'key' from deb donkey
  command 'pskey' from deb plc-utils-extra
Try: sudo apt install <deb name>

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ openssl pkey -in AlicePublicPrivateKeyPair.pem -text -noout              

DH Private-Key: (2048 bit)
private-key:
    2c:b6:c6:d3:27:ae:8b:67:c2:2f:51:93:71:6c:5d:
    cb:67:58:bf:d7:c3:0b:83:05:a8:7c:bb:ce:c2:45:
    2a:e4:05:af:f3:39:6a:e9:0b:a1:64:48:25:b3:a7:
    0f:8a:7f:a0:ed:23:6d:31:c0:5c:d8:3a:0c:01:e1:
    db:05:d8:39:77:b4:52:f0:0d:97:85:99:b1:5a:6b:
    19:84:7f:ae:a9:b6:23:c9:d4:80:b4:4f:9f:14:58:
    cb:1f:fc:b9:9f:35:ef:30:6e:92:4f:2e:84:06:f3:
    b3:c2:20:78:61:91:ac:23:a8:f4:19:e7:b2:34:9b:
    6f:2a:bd:26:45:da:92:2b:ee:4f:7d:c1:a9:5a:7a:
    73:10:b4:6d:84:15:68:24:f9:12:c2:c2:3a:d2:40:
    8a:d8:05:ed:26:6f:cb:77:da:6d:ba:cd:4e:99:91:
    15:ff:2e:96:dc:dd:c9:13:f9:95:18:5b:21:91:4a:
    07:43:bf:24:ca:a5:c5:bc:68:99:ce:5f:7f:ef:56:
    e6:4e:bc:c1:71:a1:06:be:44:6e:e6:ed:e2:5e:f1:
    a4:83:b4:ff:df:8c:2a:16:b0:83:4d:19:10:a0:b6:
    28:19:a9:f9:68:11:17:57:a0:e0:ae:b2:e8:93:d4:
    b5:61:a0:c9:c2:c0:c3:1a:67:e8:2b:6f:e4:fc:78:
    97
public-key:
    35:a6:f5:e4:99:91:83:32:77:ab:2b:59:4e:c5:2f:
    5e:02:e2:06:6a:8f:41:78:47:67:fc:be:36:de:db:
    36:fe:e2:ce:34:40:14:f8:9f:22:12:ca:b3:59:c2:
    bf:94:ab:be:8b:b7:a7:be:87:16:92:ff:29:42:fc:
    fc:54:fe:1b:ea:57:20:cf:e1:d4:44:f1:1d:71:28:
    95:86:19:6c:3b:db:ac:c4:56:47:f9:c7:f6:f6:26:
    8c:6a:3c:c6:9c:87:de:e6:6c:7c:d9:46:c6:fa:9e:
    bf:5f:98:25:d8:f7:21:85:7f:14:84:eb:80:2a:ea:
    59:41:65:d2:c0:7e:3e:77:c7:1c:d5:60:ed:9c:57:
    bc:0f:f6:5e:52:18:89:42:8a:ac:f9:1d:93:4d:ff:
    ce:0d:b4:b4:89:5a:af:92:ab:ed:c9:c1:73:2d:39:
    80:be:e5:b6:8e:64:e5:a4:95:7c:a0:3a:1b:c1:f6:
    20:3b:da:2e:4a:ae:f2:c1:70:ae:38:44:2c:31:95:
    dc:8c:bf:a9:fc:07:66:8c:b4:2e:ab:00:9b:53:16:
    3f:7b:08:ad:27:90:db:52:10:8d:88:59:2c:17:9a:
    1f:53:af:53:9f:2e:3e:52:a3:1b:ea:1c:57:6d:8e:
    29:a2:e9:ac:76:f0:18:ae:da:1f:06:24:6d:f0:88:
    60
P:   
    00:bb:9b:c0:62:59:0e:af:58:b0:4c:b0:b0:6a:ee:
    22:1e:08:08:0d:00:e1:e3:e7:9f:52:46:2a:b5:2d:
    14:61:9d:5f:e3:76:59:50:83:2e:21:d2:6d:21:4b:
    2a:0e:d8:e5:8b:e5:cf:8e:ba:53:c5:49:e3:a9:fd:
    cc:3f:47:f1:32:07:69:20:7e:21:ae:d7:7b:00:0c:
    84:6f:b2:e0:96:d8:44:63:72:a5:2c:9a:cf:b7:2b:
    25:d5:e5:c8:e7:e5:65:d4:2b:93:25:1a:ff:5c:71:
    2c:43:4f:2b:3d:6f:ac:c2:f2:2c:3f:0d:18:e5:e4:
    7a:e6:59:45:f1:e2:b0:e2:55:5d:3a:43:7d:4e:c7:
    00:78:cb:22:88:33:70:cb:32:56:37:09:aa:5e:3b:
    e4:15:9e:a9:63:46:69:5d:37:d7:f2:f4:c8:b3:2e:
    5b:ad:67:bc:7b:69:a3:1b:f8:fb:1f:bf:05:80:1e:
    de:f3:16:9e:a8:14:19:7e:a1:1f:6b:56:5c:1e:6b:
    07:c9:ff:6d:25:38:23:8a:a2:71:ac:20:46:81:ac:
    93:90:d3:fd:24:15:44:52:36:41:bc:55:53:b1:2f:
    c3:55:dd:0d:75:81:26:43:f7:ce:61:4e:6d:dd:96:
    5f:7b:85:b5:c6:1a:ca:3e:f5:e5:d9:56:b3:3e:8a:
    de:67
G:    2 (0x2)

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ openssl genpkey -paramfile parametersPG.pem -out BobPublicPrivateKeyPair.pem

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ openssl pkey -in AlicePublicPrivateKeyPair.pem -pubout -out AlicePublicKey.pem


┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ openssl pkey -in BobPublicPrivateKeyPair.pem -pubout -out BobPublicKey.pem


┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ openssl pkey -pubin -in BobPublicKey.pem -text                           
-----BEGIN PUBLIC KEY-----
MIICJTCCARcGCSqGSIb3DQEDATCCAQgCggEBALubwGJZDq9YsEywsGruIh4ICA0A
4ePnn1JGKrUtFGGdX+N2WVCDLiHSbSFLKg7Y5Yvlz466U8VJ46n9zD9H8TIHaSB+
Ia7XewAMhG+y4JbYRGNypSyaz7crJdXlyOflZdQrkyUa/1xxLENPKz1vrMLyLD8N
GOXkeuZZRfHisOJVXTpDfU7HAHjLIogzcMsyVjcJql475BWeqWNGaV031/L0yLMu
W61nvHtpoxv4+x+/BYAe3vMWnqgUGX6hH2tWXB5rB8n/bSU4I4qicawgRoGsk5DT
/SQVRFI2QbxVU7Evw1XdDXWBJkP3zmFObd2WX3uFtcYayj715dlWsz6K3mcCAQID
ggEGAAKCAQEAhhKgZLuaVdIqHNGQzpLtNQVDz6/TJDiR1AQJQnzJjYZUjom9K/Rh
nDDkDQfleOxOKyDcVJDIqbADP35nFvpJQrOP5JZ8Xudhn4iZDPSut2nbUWWa8caR
0WQSAV9FL8aOs97uze8UP7hl2cdOLpHVparZR4iDFeQYcAh6j0H2LHLcNm/ieNya
8xk9BU+gG6xW+SKQQ4Er1008pf6fupojLsFtkQ2tR02Pv4CbI8r5BVbsNOO//njz
uMIDZ2OIGDPNBFEDL9hn+LAOGy6ocXPDEljvBkoExtcLHfIGYNiq1FW/NwjBYtrk
E5H/DR8siaLy33ZsaX6hjtASkEkUbHvtGQ==
-----END PUBLIC KEY-----
DH Public-Key: (2048 bit)
public-key:
    00:86:12:a0:64:bb:9a:55:d2:2a:1c:d1:90:ce:92:
    ed:35:05:43:cf:af:d3:24:38:91:d4:04:09:42:7c:
    c9:8d:86:54:8e:89:bd:2b:f4:61:9c:30:e4:0d:07:
    e5:78:ec:4e:2b:20:dc:54:90:c8:a9:b0:03:3f:7e:
    67:16:fa:49:42:b3:8f:e4:96:7c:5e:e7:61:9f:88:
    99:0c:f4:ae:b7:69:db:51:65:9a:f1:c6:91:d1:64:
    12:01:5f:45:2f:c6:8e:b3:de:ee:cd:ef:14:3f:b8:
    65:d9:c7:4e:2e:91:d5:a5:aa:d9:47:88:83:15:e4:
    18:70:08:7a:8f:41:f6:2c:72:dc:36:6f:e2:78:dc:
    9a:f3:19:3d:05:4f:a0:1b:ac:56:f9:22:90:43:81:
    2b:d7:4d:3c:a5:fe:9f:ba:9a:23:2e:c1:6d:91:0d:
    ad:47:4d:8f:bf:80:9b:23:ca:f9:05:56:ec:34:e3:
    bf:fe:78:f3:b8:c2:03:67:63:88:18:33:cd:04:51:
    03:2f:d8:67:f8:b0:0e:1b:2e:a8:71:73:c3:12:58:
    ef:06:4a:04:c6:d7:0b:1d:f2:06:60:d8:aa:d4:55:
    bf:37:08:c1:62:da:e4:13:91:ff:0d:1f:2c:89:a2:
    f2:df:76:6c:69:7e:a1:8e:d0:12:90:49:14:6c:7b:
    ed:19
P:   
    00:bb:9b:c0:62:59:0e:af:58:b0:4c:b0:b0:6a:ee:
    22:1e:08:08:0d:00:e1:e3:e7:9f:52:46:2a:b5:2d:
    14:61:9d:5f:e3:76:59:50:83:2e:21:d2:6d:21:4b:
    2a:0e:d8:e5:8b:e5:cf:8e:ba:53:c5:49:e3:a9:fd:
    cc:3f:47:f1:32:07:69:20:7e:21:ae:d7:7b:00:0c:
    84:6f:b2:e0:96:d8:44:63:72:a5:2c:9a:cf:b7:2b:
    25:d5:e5:c8:e7:e5:65:d4:2b:93:25:1a:ff:5c:71:
    2c:43:4f:2b:3d:6f:ac:c2:f2:2c:3f:0d:18:e5:e4:
    7a:e6:59:45:f1:e2:b0:e2:55:5d:3a:43:7d:4e:c7:
    00:78:cb:22:88:33:70:cb:32:56:37:09:aa:5e:3b:
    e4:15:9e:a9:63:46:69:5d:37:d7:f2:f4:c8:b3:2e:
    5b:ad:67:bc:7b:69:a3:1b:f8:fb:1f:bf:05:80:1e:
    de:f3:16:9e:a8:14:19:7e:a1:1f:6b:56:5c:1e:6b:
    07:c9:ff:6d:25:38:23:8a:a2:71:ac:20:46:81:ac:
    93:90:d3:fd:24:15:44:52:36:41:bc:55:53:b1:2f:
    c3:55:dd:0d:75:81:26:43:f7:ce:61:4e:6d:dd:96:
    5f:7b:85:b5:c6:1a:ca:3e:f5:e5:d9:56:b3:3e:8a:
    de:67
G:    2 (0x2)

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ openssl pkeyutl -derive -inkey AlicePublicPrivateKeyPair.pem -peerkey BobPublicKey.pem -out AliceSharedSecret.bin


┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ openssl pkeyutl -derive -inkey BobPublicPrivateKeyPair.pem -peerkey AlicePublicKey.pem -out BobSharedSecret.bin

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ xxd AliceSharedSecret.bin                                                

00000000: 6906 1b80 6ca8 8622 342c e242 b5c2 3175  i...l.."4,.B..1u
00000010: f254 8486 893f ffb5 4813 1120 fd31 26c6  .T...?..H.. .1&.
00000020: cd5f 5e7d 1b3d 9326 d5be 2633 e578 7ee5  ._^}.=.&..&3.x~.
00000030: 873b eadb ea1b 840d c9de 20b8 1cca b657  .;........ ....W
00000040: f430 cd4c 5224 50ee 6263 098b 0600 4088  .0.LR$P.bc....@.
00000050: 27b3 f85e f75e 6db7 1586 3d30 b276 e6a5  '..^.^m...=0.v..
00000060: 7cd6 2356 4dfc 515d 56ee ff60 753c 4d0a  |.#VM.Q]V..`u<M.
00000070: 38c4 ced3 271f f119 2131 b15e bdc3 87c1  8...'...!1.^....
00000080: 277e 6a86 dc6a e435 6f59 816d 072f 2925  '~j..j.5oY.m./)%
00000090: e86f 7b2c 2a3c a7af 9d52 39e9 7614 d650  .o{,*<...R9.v..P
000000a0: 9b9a 02cc 3d9f 7930 a1b7 216b 30d8 1d7f  ....=.y0..!k0...
000000b0: fda4 58e8 c0f4 9f97 afe8 f8ca a1d7 3df4  ..X...........=.
000000c0: 4b7f d351 878c e55e 18b7 f6a2 f7ce 4f85  K..Q...^......O.
000000d0: 0566 be49 a9aa 6f0a 4da1 4ef4 5f65 0899  .f.I..o.M.N._e..
000000e0: ffc4 7f36 649c 98d1 9347 fbe3 79b3 e5f4  ...6d....G..y...
000000f0: 5df3 efca 13a9 faa9 b415 fb27 f7bc 8e1c  ]..........'....

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ cmp AliceSharedSecret.bin BobSharedSecret.bin                            

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ cp AliceSharedSecret.bin AliceSharedSecret.txt                           

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ cp BobSharedSecret.bin BobSharedSecret.txt                           

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ openssl enc -aes-256-ctr -pbkdf2 -e -a -in plain.txt -out encrypted.txt -pass file:AliceSharedSecret.bin
Can't open "plain.txt" for reading, No such file or directory
40A78EF4E07F0000:error:80000002:system library:BIO_new_file:No such file or directory:../crypto/bio/bss_file.c:67:calling fopen(plain.txt, rb)
40A78EF4E07F0000:error:10000080:BIO routines:BIO_new_file:no such file:../crypto/bio/bss_file.c:75:

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ touch plain.txt                                                          

┌──(kali㉿Kali)-[~/Desktop/Cybersecurity/Diffie-Hellman]
└─$ openssl enc -aes-256-ctr -pbkdf2 -e -a -in plain.txt -out encrypted.txt -pass file:AliceSharedSecret.bin
